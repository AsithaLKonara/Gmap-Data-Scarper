import{c as B,j as e,r as o,u as ce,a as le,b as F,g as P,B as H,C as ie,H as J,d as I,e as v,G as de,f as w,S as T,h as E,i as A,k as M,I as p,l as q,F as he,m as ue,A as xe,n as je,T as me,o as pe,p as K,q as h,s as ge,t as u,v as ve,w as _,x as k,E as Ce,M as ye,y as fe,z as Se,D as Le,J as be,K as we,L as Te,V as Ee,N as x,O as j,P as Ae,Q as Me,R as Ie}from"./index-D0kUkWFl.js";import{S as U}from"./stat-arrow-DPyti7wb.js";const Ne=B({d:"M0,12a1.5,1.5,0,0,0,1.5,1.5h8.75a.25.25,0,0,1,.25.25V22.5a1.5,1.5,0,0,0,3,0V13.75a.25.25,0,0,1,.25-.25H22.5a1.5,1.5,0,0,0,0-3H13.75a.25.25,0,0,1-.25-.25V1.5a1.5,1.5,0,0,0-3,0v8.75a.25.25,0,0,1-.25.25H1.5A1.5,1.5,0,0,0,0,12Z",displayName:"AddIcon"}),ze=B({displayName:"ViewIcon",path:e.jsxs("g",{fill:"currentColor",children:[e.jsx("path",{d:"M23.432,10.524C20.787,7.614,16.4,4.538,12,4.6,7.6,4.537,3.213,7.615.568,10.524a2.211,2.211,0,0,0,0,2.948C3.182,16.351,7.507,19.4,11.839,19.4h.308c4.347,0,8.671-3.049,11.288-5.929A2.21,2.21,0,0,0,23.432,10.524ZM7.4,12A4.6,4.6,0,1,1,12,16.6,4.6,4.6,0,0,1,7.4,12Z"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})}),Re=B({displayName:"DeleteIcon",path:e.jsx("g",{fill:"currentColor",children:e.jsx("path",{d:"M19.452 7.5H4.547a.5.5 0 00-.5.545l1.287 14.136A2 2 0 007.326 24h9.347a2 2 0 001.992-1.819L19.95 8.045a.5.5 0 00-.129-.382.5.5 0 00-.369-.163zm-9.2 13a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zm5 0a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zM22 4h-4.75a.25.25 0 01-.25-.25V2.5A2.5 2.5 0 0014.5 0h-5A2.5 2.5 0 007 2.5v1.25a.25.25 0 01-.25.25H2a1 1 0 000 2h20a1 1 0 000-2zM9 3.75V2.5a.5.5 0 01.5-.5h5a.5.5 0 01.5.5v1.25a.25.25 0 01-.25.25h-5.5A.25.25 0 019 3.75z"})})}),He=()=>{const[t,C]=o.useState([]),[l,a]=o.useState(null),[c,y]=o.useState(!1),[r,W]=o.useState(!1),[N,z]=o.useState(null),[R,X]=o.useState(""),[D,Y]=o.useState(""),[g,$]=o.useState(""),i=ce(),{isOpen:ee,onOpen:f,onClose:S}=le(),O=F("white","gray.800"),G=F("gray.200","gray.700");o.useEffect(()=>{L(),b()},[]);const L=async()=>{y(!0);try{const s=await P();C(s||[])}catch(s){console.error(s),i({title:"Error",description:s.message,status:"error",duration:3e3})}finally{y(!1)}},b=async()=>{W(!0);try{const s=await P(),n=(s==null?void 0:s.length)||0,m=(s==null?void 0:s.filter(d=>d.status==="new").length)||0,V=(s==null?void 0:s.filter(d=>d.status==="contacted").length)||0,oe=(s==null?void 0:s.filter(d=>d.status==="qualified").length)||0,Z=(s==null?void 0:s.filter(d=>d.status==="converted").length)||0;a({total_leads:n,new_leads:m,contacted_leads:V,qualified_leads:oe,converted_leads:Z,conversion_rate:n>0?Z/n*100:0})}catch(s){console.error(s)}finally{W(!1)}},se=async s=>{try{await Ie(s),i({title:"Success",description:"Lead added successfully",status:"success",duration:3e3}),L(),b(),S()}catch(n){console.error(n),i({title:"Error",description:n.message,status:"error",duration:3e3})}},te=async(s,n)=>{try{await Me(s,n),i({title:"Success",description:"Lead updated successfully",status:"success",duration:3e3}),L(),b(),S()}catch(m){console.error(m),i({title:"Error",description:m.message,status:"error",duration:3e3})}},ae=async s=>{if(confirm("Are you sure you want to delete this lead?"))try{await Te(s),i({title:"Success",description:"Lead deleted successfully",status:"success",duration:3e3}),L(),b()}catch(n){console.error(n),i({title:"Error",description:n.message,status:"error",duration:3e3})}},re=s=>{switch(s){case"new":return"blue";case"contacted":return"yellow";case"qualified":return"orange";case"converted":return"green";default:return"gray"}},Q=t.filter(s=>{const n=!R||s.status===R,m=!D||s.tag===D,V=!g||s.name.toLowerCase().includes(g.toLowerCase())||s.email.toLowerCase().includes(g.toLowerCase())||s.company&&s.company.toLowerCase().includes(g.toLowerCase());return n&&m&&V}),ne=[...new Set(t.map(s=>s.tag).filter(Boolean))];return e.jsxs(H,{minH:"100vh",bg:F("gray.100","gray.800"),"data-tour":"crm-main",children:[e.jsxs(ie,{maxW:"container.xl",py:8,"data-tour":"crm-content",children:[e.jsx(J,{size:"lg",mb:6,className:"gradient-text","data-tour":"crm-title",children:"CRM Leads"}),e.jsxs(I,{justify:"space-between",mb:4,"data-tour":"crm-actions",children:[e.jsx(v,{colorScheme:"blue",onClick:f,"data-tour":"crm-add-lead",children:"Add Lead"}),e.jsx(v,{colorScheme:"green",onClick:handleExportLeads,"data-tour":"crm-export",children:"Export Leads"})]}),l&&e.jsxs(de,{templateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:6,children:[e.jsx(w,{children:e.jsxs(T,{children:[e.jsx(E,{children:"Total Leads"}),e.jsx(A,{children:l.total_leads}),e.jsxs(M,{children:[e.jsx(U,{type:"increase"}),"23.36%"]})]})}),e.jsx(w,{children:e.jsxs(T,{children:[e.jsx(E,{children:"New Leads"}),e.jsx(A,{children:l.new_leads}),e.jsx(M,{children:"This month"})]})}),e.jsx(w,{children:e.jsxs(T,{children:[e.jsx(E,{children:"Conversion Rate"}),e.jsxs(A,{children:[l.conversion_rate.toFixed(1),"%"]}),e.jsxs(M,{children:[e.jsx(U,{type:"increase"}),"12.5%"]})]})}),e.jsx(w,{children:e.jsxs(T,{children:[e.jsx(E,{children:"Converted"}),e.jsx(A,{children:l.converted_leads}),e.jsx(M,{children:"This month"})]})})]}),e.jsx(H,{bg:O,p:6,borderRadius:"lg",border:"1px",borderColor:G,children:e.jsxs(I,{spacing:4,mb:4,children:[e.jsx(p,{placeholder:"Search leads...",value:g,onChange:s=>$(s.target.value),maxW:"300px"}),e.jsxs(q,{placeholder:"Filter by status",value:R,onChange:s=>X(s.target.value),maxW:"200px",children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"qualified",children:"Qualified"}),e.jsx("option",{value:"converted",children:"Converted"})]}),e.jsx(q,{placeholder:"Filter by tag",value:D,onChange:s=>Y(s.target.value),maxW:"200px",children:ne.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx(v,{leftIcon:e.jsx(Ne,{}),colorScheme:"blue",onClick:()=>{z(null),f()},children:"Add Lead"})]})}),e.jsxs(H,{bg:O,p:6,borderRadius:"lg",border:"1px",borderColor:G,children:[e.jsx(J,{size:"md",mb:4,children:"Leads"}),c?e.jsx(he,{justify:"center",py:8,children:e.jsx(ue,{size:"lg"})}):Q.length===0?e.jsxs(xe,{status:"info",children:[e.jsx(je,{}),"No leads found. Add your first lead to get started!"]}):e.jsxs(me,{variant:"simple",children:[e.jsx(pe,{children:e.jsxs(K,{children:[e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Email"}),e.jsx(h,{children:"Company"}),e.jsx(h,{children:"Status"}),e.jsx(h,{children:"Tag"}),e.jsx(h,{children:"Created"}),e.jsx(h,{children:"Actions"})]})}),e.jsx(ge,{children:Q.map(s=>e.jsxs(K,{children:[e.jsx(u,{fontWeight:"bold",children:s.name}),e.jsx(u,{children:s.email}),e.jsx(u,{children:s.company||"-"}),e.jsx(u,{children:e.jsx(ve,{colorScheme:re(s.status),children:s.status})}),e.jsx(u,{children:s.tag||"-"}),e.jsx(u,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(u,{children:e.jsxs(I,{spacing:2,children:[e.jsx(_,{label:"View Details",children:e.jsx(k,{"aria-label":"View lead",icon:e.jsx(ze,{}),size:"sm",variant:"ghost",onClick:()=>{z(s),f()}})}),e.jsx(_,{label:"Edit Lead",children:e.jsx(k,{"aria-label":"Edit lead",icon:e.jsx(Ce,{}),size:"sm",variant:"ghost",onClick:()=>{z(s),f()}})}),e.jsx(_,{label:"Delete Lead",children:e.jsx(k,{"aria-label":"Delete lead",icon:e.jsx(Re,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>ae(s.id)})})]})})]},s.id))})]})]})]}),e.jsxs(ye,{isOpen:ee,onClose:S,size:"lg",children:[e.jsx(fe,{}),e.jsxs(Se,{children:[e.jsx(Le,{children:N?"Edit Lead":"Add New Lead"}),e.jsx(be,{}),e.jsx(we,{children:e.jsx(De,{lead:N,onSubmit:N?te:se,onCancel:S})})]})]})]})},De=({lead:t,onSubmit:C,onCancel:l})=>{const[a,c]=o.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",company:(t==null?void 0:t.company)||"",tag:(t==null?void 0:t.tag)||"",notes:(t==null?void 0:t.notes)||"",status:(t==null?void 0:t.status)||"new"}),y=r=>{r.preventDefault(),t?C(t.id,a):C(a)};return e.jsx("form",{onSubmit:y,children:e.jsxs(Ee,{spacing:4,children:[e.jsxs(x,{isRequired:!0,children:[e.jsx(j,{children:"Name"}),e.jsx(p,{value:a.name,onChange:r=>c({...a,name:r.target.value}),placeholder:"Enter lead name"})]}),e.jsxs(x,{isRequired:!0,children:[e.jsx(j,{children:"Email"}),e.jsx(p,{type:"email",value:a.email,onChange:r=>c({...a,email:r.target.value}),placeholder:"Enter email address"})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Phone"}),e.jsx(p,{value:a.phone,onChange:r=>c({...a,phone:r.target.value}),placeholder:"Enter phone number"})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Company"}),e.jsx(p,{value:a.company,onChange:r=>c({...a,company:r.target.value}),placeholder:"Enter company name"})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Tag"}),e.jsx(p,{value:a.tag,onChange:r=>c({...a,tag:r.target.value}),placeholder:"Enter tag"})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Status"}),e.jsxs(q,{value:a.status,onChange:r=>c({...a,status:r.target.value}),children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"qualified",children:"Qualified"}),e.jsx("option",{value:"converted",children:"Converted"})]})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Notes"}),e.jsx(Ae,{value:a.notes,onChange:r=>c({...a,notes:r.target.value}),placeholder:"Enter notes about this lead",rows:3})]}),e.jsxs(I,{spacing:4,w:"full",children:[e.jsx(v,{type:"submit",colorScheme:"blue",flex:1,children:t?"Update Lead":"Add Lead"}),e.jsx(v,{onClick:l,variant:"outline",flex:1,children:"Cancel"})]})]})})};export{He as CRM};
//# sourceMappingURL=CRM-CFbsakTW.js.map
