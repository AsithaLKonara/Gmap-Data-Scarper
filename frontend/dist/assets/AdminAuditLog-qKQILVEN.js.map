{"version":3,"file":"AdminAuditLog-qKQILVEN.js","sources":["../../src/pages/AdminAuditLog.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { adminGetAuditLogs } from '../api';\nimport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableHead,\n  TableRow,\n  TableCell,\n} from '../components/ui/table';\n\nconst PAGE_SIZE = 20;\n\nconst AdminAuditLog: React.FC = () => {\n  const [logs, setLogs] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [page, setPage] = useState(1);\n  const [total, setTotal] = useState(0);\n  const [action, setAction] = useState('');\n  const [adminEmail, setAdminEmail] = useState('');\n  const [targetType, setTargetType] = useState('');\n\n  const fetchLogs = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await adminGetAuditLogs({ page, pageSize: PAGE_SIZE, action, adminEmail, targetType });\n      setLogs(res.results || []);\n      setTotal(res.total || 0);\n    } catch (e: any) {\n      setError(e.message || 'Failed to load logs');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { fetchLogs(); }, [page, action, adminEmail, targetType]);\n\n  return (\n    <div className=\"max-w-6xl mx-auto py-8 px-4\">\n      <div className=\"bg-white dark:bg-gray-900 p-8 rounded-lg shadow-md\">\n        <h1 className=\"text-2xl font-bold mb-4\">Admin Audit Log</h1>\n        <div className=\"flex gap-2 mb-4\">\n          <input\n            className=\"border px-2 py-1 rounded\"\n            placeholder=\"Action\"\n            value={action}\n            onChange={e => { setAction(e.target.value); setPage(1); }}\n          />\n          <input\n            className=\"border px-2 py-1 rounded\"\n            placeholder=\"User Email\"\n            value={adminEmail}\n            onChange={e => { setAdminEmail(e.target.value); setPage(1); }}\n          />\n          <input\n            className=\"border px-2 py-1 rounded\"\n            placeholder=\"Target Type\"\n            value={targetType}\n            onChange={e => { setTargetType(e.target.value); setPage(1); }}\n          />\n          <button className=\"bg-blue-500 text-white px-3 py-1 rounded\" onClick={() => fetchLogs()}>Search</button>\n        </div>\n        {loading ? (\n          <div className=\"flex justify-center py-8\">\n            <div className=\"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\n          </div>\n        ) : error ? (\n          <div className=\"flex items-center p-4 mb-4 text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400\">\n            {error}\n          </div>\n        ) : logs.length === 0 ? (\n          <p className=\"text-gray-500\">No audit logs found.</p>\n        ) : (\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Action</TableHead>\n                <TableHead>User</TableHead>\n                <TableHead>Target</TableHead>\n                <TableHead>Details</TableHead>\n                <TableHead>Timestamp</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {logs.map(log => (\n                <TableRow key={log.id}>\n                  <TableCell>{log.action}</TableCell>\n                  <TableCell>{log.user_email || '-'}</TableCell>\n                  <TableCell>{log.target_type}{log.target_id ? ` #${log.target_id}` : ''}</TableCell>\n                  <TableCell><pre className=\"whitespace-pre-wrap text-xs\">{log.details}</pre></TableCell>\n                  <TableCell>{new Date(log.timestamp).toLocaleString()}</TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        )}\n        {/* Pagination */}\n        <div className=\"flex gap-2 mt-4 justify-end\">\n          <button\n            className=\"px-3 py-1 rounded bg-gray-200\"\n            onClick={() => setPage(p => Math.max(1, p - 1))}\n            disabled={page === 1}\n          >Prev</button>\n          <span>Page {page} / {Math.ceil(total / PAGE_SIZE) || 1}</span>\n          <button\n            className=\"px-3 py-1 rounded bg-gray-200\"\n            onClick={() => setPage(p => p + 1)}\n            disabled={page >= Math.ceil(total / PAGE_SIZE)}\n          >Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminAuditLog; "],"names":["PAGE_SIZE","AdminAuditLog","logs","setLogs","useState","loading","setLoading","error","setError","page","setPage","total","setTotal","action","setAction","adminEmail","setAdminEmail","targetType","setTargetType","fetchLogs","res","adminGetAuditLogs","e","useEffect","jsxs","jsx","Table","TableHeader","TableRow","TableHead","TableBody","log","TableCell","p"],"mappings":"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"}